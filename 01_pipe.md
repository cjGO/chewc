

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

------------------------------------------------------------------------

<a href="https://github.com/cjGO/chewc/blob/main/chewc/pipe.py#L118"
target="_blank" style="float:right; font-size:smaller">source</a>

### run_simulation_cycles

>  run_simulation_cycles (initial_state:chewc.structs.BreedingState,
>                             trait:chewc.structs.Trait,
>                             genetic_map:chewc.structs.GeneticMap,
>                             heritabilities:jax.Array, n_cycles:int,
>                             n_select:int, n_offspring:int, max_crossovers:int)

\*Runs the entire multi-cycle simulation using lax.scan for high
performance.

Args: initial_state (BreedingState): Starting state of the simulation.
trait (Trait): Trait architecture. genetic_map (GeneticMap): Genetic
map. heritabilities (jnp.ndarray): Heritability values. n_cycles (int):
Number of selection cycles to run. n_select (int): Number of parents to
select per cycle. n_offspring (int): Number of offspring to produce per
cycle. max_crossovers (int): Maximum crossovers per chromosome.

Returns: final_state (BreedingState): The state after the last cycle.
history (jnp.ndarray): Array of shape (n_cycles, 2) containing
\[mean_tbv, mean_phenotype\] for each generation.\*

------------------------------------------------------------------------

<a href="https://github.com/cjGO/chewc/blob/main/chewc/pipe.py#L26"
target="_blank" style="float:right; font-size:smaller">source</a>

### phenotypic_selection_step

>  phenotypic_selection_step (carry:chewc.structs.BreedingState, _,
>                                 trait:chewc.structs.Trait,
>                                 genetic_map:chewc.structs.GeneticMap,
>                                 heritabilities:jax.Array, n_select:int,
>                                 n_offspring:int, max_crossovers:int)

\*Executes one full cycle of phenotypic selection and breeding.

This function performs the following steps: 1. Phenotyping: Calculates
phenotypes and True Breeding Values (TBVs). 2. Selection: Selects top
`n_select` parents based on the first trait (index 0). 3. Mating:
Generates a random mating plan. 4. Crossing: Simulates meiosis and
crossover to create the next generation. 5. Update: Updates the
simulation state (generation, IDs, pedigree).

Args: carry (BreedingState): Current simulation state. \_ (Any): Ignored
loop iterator from lax.scan. trait (Trait): Trait architecture.
genetic_map (GeneticMap): Genetic map for recombination. heritabilities
(jnp.ndarray): Heritability values for phenotypes. n_select (int):
Number of parents to select. n_offspring (int): Number of offspring to
generate. max_crossovers (int): Maximum crossovers per chromosome.

Returns: next_state (BreedingState): The updated simulation state.
metrics (jnp.ndarray): Array \[mean_tbv, mean_phenotype\] for the first
trait.\*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>carry</td>
<td>BreedingState</td>
<td></td>
</tr>
<tr>
<td>_</td>
<td></td>
<td>Placeholder for lax.scanâ€™s iteration number</td>
</tr>
<tr>
<td>trait</td>
<td>Trait</td>
<td></td>
</tr>
<tr>
<td>genetic_map</td>
<td>GeneticMap</td>
<td></td>
</tr>
<tr>
<td>heritabilities</td>
<td>Array</td>
<td></td>
</tr>
<tr>
<td>n_select</td>
<td>int</td>
<td></td>
</tr>
<tr>
<td>n_offspring</td>
<td>int</td>
<td></td>
</tr>
<tr>
<td>max_crossovers</td>
<td>int</td>
<td></td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Tuple</strong></td>
<td></td>
</tr>
</tbody>
</table>
