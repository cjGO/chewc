# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/01_config.ipynb.

# %% auto 0
__all__ = ['Population', 'Trait', 'StaticConfig', 'DynamicConfig']

# %% ../nbs/01_config.ipynb 2
from flax.struct import dataclass
import jax.numpy as jnp
from typing import Tuple

# %% ../nbs/01_config.ipynb 3
@dataclass(frozen=True)
class Population:
    # geno: (N, n_chr, ploidy=2, n_loci)
    geno: jnp.ndarray
    # meta columns: [id, mother_id, father_id, birth_gen]
    meta: jnp.ndarray

@dataclass(frozen=True)
class Trait:
    # QTL location and additive effects across traits
    qtl_chromosome: jnp.ndarray   # (Q,)
    qtl_position: jnp.ndarray     # (Q,)
    qtl_effects: jnp.ndarray      # (Q, n_traits)
    intercept: jnp.ndarray        # (n_traits,)

@dataclass(frozen=True)
class StaticConfig:
    n_chr: int
    n_loci_per_chr: int
    ploidy: int
    n_select: int
    n_offspring: int

@dataclass(frozen=True)
class DynamicConfig:
    genetic_map: jnp.ndarray              # (n_chr, n_loci)
    traits: Tuple[Trait, ...]             # tuple for pytree stability
    locus_positions: jnp.ndarray          # (n_chr, n_loci), cumsum of genetic_map
